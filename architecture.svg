<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="neuronGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4A90E2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#357ABD;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="inputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7ED321;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#5BB318;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="outputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F5A623;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E89611;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" class="title" font-size="24" font-weight="bold" fill="#333">
    DQN Recommender: Deep Neural Network Architecture
  </text>
  
  <!-- Input Layer -->
  <text x="80" y="80" text-anchor="middle" font-size="14" font-weight="bold" fill="#333">Input Layer</text>
  <text x="80" y="95" text-anchor="middle" font-size="12" fill="#666">State Dimension</text>
  
  <!-- Input neurons -->
  <circle cx="80" cy="120" r="12" fill="url(#inputGradient)" stroke="#333" stroke-width="2"/>
  <circle cx="80" cy="150" r="12" fill="url(#inputGradient)" stroke="#333" stroke-width="2"/>
  <circle cx="80" cy="180" r="12" fill="url(#inputGradient)" stroke="#333" stroke-width="2"/>
  <circle cx="80" cy="210" r="12" fill="url(#inputGradient)" stroke="#333" stroke-width="2"/>
  <text x="80" y="240" text-anchor="middle" font-size="12" fill="#666">...</text>
  <circle cx="80" cy="270" r="12" fill="url(#inputGradient)" stroke="#333" stroke-width="2"/>
  
  <!-- Input labels -->
  <text x="20" y="125" font-size="10" fill="#666">User Features</text>
  <text x="20" y="155" font-size="10" fill="#666">Item History</text>
  <text x="20" y="185" font-size="10" fill="#666">Context</text>
  <text x="20" y="215" font-size="10" fill="#666">Preferences</text>
  <text x="20" y="275" font-size="10" fill="#666">Session Info</text>
  
  <!-- Hidden Layer 1 -->
  <text x="250" y="80" text-anchor="middle" font-size="14" font-weight="bold" fill="#333">Hidden Layer 1</text>
  <text x="250" y="95" text-anchor="middle" font-size="12" fill="#666">256 neurons + ReLU</text>
  
  <!-- Hidden Layer 1 neurons -->
  <g id="hidden1">
    <circle cx="250" cy="110" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="250" cy="130" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="250" cy="150" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="250" cy="170" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="250" cy="190" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="250" cy="210" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="250" cy="230" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="250" cy="250" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <text x="250" y="275" text-anchor="middle" font-size="12" fill="#666">...</text>
    <circle cx="250" cy="300" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
  </g>
  
  <!-- Dropout 1 -->
  <text x="320" y="205" text-anchor="middle" font-size="11" fill="#E74C3C" font-weight="bold">Dropout</text>
  <text x="320" y="218" text-anchor="middle" font-size="10" fill="#E74C3C">(0.2)</text>
  
  <!-- Hidden Layer 2 -->
  <text x="420" y="80" text-anchor="middle" font-size="14" font-weight="bold" fill="#333">Hidden Layer 2</text>
  <text x="420" y="95" text-anchor="middle" font-size="12" fill="#666">256 neurons + ReLU</text>
  
  <!-- Hidden Layer 2 neurons -->
  <g id="hidden2">
    <circle cx="420" cy="110" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="420" cy="130" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="420" cy="150" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="420" cy="170" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="420" cy="190" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="420" cy="210" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="420" cy="230" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="420" cy="250" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <text x="420" y="275" text-anchor="middle" font-size="12" fill="#666">...</text>
    <circle cx="420" cy="300" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
  </g>
  
  <!-- Dropout 2 -->
  <text x="490" y="205" text-anchor="middle" font-size="11" fill="#E74C3C" font-weight="bold">Dropout</text>
  <text x="490" y="218" text-anchor="middle" font-size="10" fill="#E74C3C">(0.2)</text>
  
  <!-- Hidden Layer 3 -->
  <text x="590" y="80" text-anchor="middle" font-size="14" font-weight="bold" fill="#333">Hidden Layer 3</text>
  <text x="590" y="95" text-anchor="middle" font-size="12" fill="#666">128 neurons + ReLU</text>
  
  <!-- Hidden Layer 3 neurons -->
  <g id="hidden3">
    <circle cx="590" cy="125" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="590" cy="150" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="590" cy="175" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="590" cy="200" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <circle cx="590" cy="225" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
    <text x="590" y="255" text-anchor="middle" font-size="12" fill="#666">...</text>
    <circle cx="590" cy="275" r="10" fill="url(#neuronGradient)" stroke="#333" stroke-width="1.5"/>
  </g>
  
  <!-- Output Layer -->
  <text x="750" y="80" text-anchor="middle" font-size="14" font-weight="bold" fill="#333">Output Layer</text>
  <text x="750" y="95" text-anchor="middle" font-size="12" fill="#666">Action Dimension (Items)</text>
  <text x="750" y="108" text-anchor="middle" font-size="11" fill="#666">Linear Activation</text>
  
  <!-- Output neurons (Q-values) -->
  <circle cx="750" cy="130" r="12" fill="url(#outputGradient)" stroke="#333" stroke-width="2"/>
  <circle cx="750" cy="160" r="12" fill="url(#outputGradient)" stroke="#333" stroke-width="2"/>
  <circle cx="750" cy="190" r="12" fill="url(#outputGradient)" stroke="#333" stroke-width="2"/>
  <circle cx="750" cy="220" r="12" fill="url(#outputGradient)" stroke="#333" stroke-width="2"/>
  <text x="750" y="250" text-anchor="middle" font-size="12" fill="#666">...</text>
  <circle cx="750" cy="280" r="12" fill="url(#outputGradient)" stroke="#333" stroke-width="2"/>
  
  <!-- Q-value labels -->
  <text x="810" y="135" font-size="10" fill="#666">Q(s, item_0)</text>
  <text x="810" y="165" font-size="10" fill="#666">Q(s, item_1)</text>
  <text x="810" y="195" font-size="10" fill="#666">Q(s, item_2)</text>
  <text x="810" y="225" font-size="10" fill="#666">Q(s, item_3)</text>
  <text x="810" y="285" font-size="10" fill="#666">Q(s, item_n)</text>
  
  <!-- Connections (sample) -->
  <g stroke="#666" stroke-width="0.5" opacity="0.6">
    <!-- Input to Hidden1 -->
    <line x1="92" y1="120" x2="240" y2="130"/>
    <line x1="92" y1="150" x2="240" y2="150"/>
    <line x1="92" y1="180" x2="240" y2="170"/>
    <line x1="92" y1="210" x2="240" y2="190"/>
    <line x1="92" y1="270" x2="240" y2="250"/>
    
    <!-- Hidden1 to Hidden2 -->
    <line x1="260" y1="130" x2="410" y2="150"/>
    <line x1="260" y1="170" x2="410" y2="190"/>
    <line x1="260" y1="210" x2="410" y2="210"/>
    <line x1="260" y1="250" x2="410" y2="230"/>
    
    <!-- Hidden2 to Hidden3 -->
    <line x1="430" y1="150" x2="580" y2="175"/>
    <line x1="430" y1="190" x2="580" y2="200"/>
    <line x1="430" y1="230" x2="580" y2="225"/>
    
    <!-- Hidden3 to Output -->
    <line x1="600" y1="150" x2="738" y2="160"/>
    <line x1="600" y1="200" x2="738" y2="190"/>
    <line x1="600" y1="225" x2="738" y2="220"/>
  </g>
  
  <!-- DRL Framework Box -->
  <rect x="50" y="350" width="700" height="200" fill="none" stroke="#2C3E50" stroke-width="2" rx="10"/>
  <text x="400" y="375" text-anchor="middle" font-size="16" font-weight="bold" fill="#2C3E50">Deep Reinforcement Learning Framework</text>
  
  <!-- Agent Box -->
  <rect x="80" y="400" width="150" height="120" fill="#ECF0F1" stroke="#34495E" stroke-width="1.5" rx="5"/>
  <text x="155" y="420" text-anchor="middle" font-size="12" font-weight="bold" fill="#2C3E50">DQN Agent</text>
  <text x="155" y="440" text-anchor="middle" font-size="10" fill="#34495E">• Q-Network (above)</text>
  <text x="155" y="455" text-anchor="middle" font-size="10" fill="#34495E">• Target Network</text>
  <text x="155" y="470" text-anchor="middle" font-size="10" fill="#34495E">• Experience Replay</text>
  <text x="155" y="485" text-anchor="middle" font-size="10" fill="#34495E">• ε-greedy Policy</text>
  <text x="155" y="500" text-anchor="middle" font-size="10" fill="#34495E">• Batch Size: 32</text>
  
  <!-- Environment Box -->
  <rect x="280" y="400" width="150" height="120" fill="#ECF0F1" stroke="#34495E" stroke-width="1.5" rx="5"/>
  <text x="355" y="420" text-anchor="middle" font-size="12" font-weight="bold" fill="#2C3E50">Environment</text>
  <text x="355" y="440" text-anchor="middle" font-size="10" fill="#34495E">• User Sessions</text>
  <text x="355" y="455" text-anchor="middle" font-size="10" fill="#34495E">• Item Catalog</text>
  <text x="355" y="470" text-anchor="middle" font-size="10" fill="#34495E">• Reward Function</text>
  <text x="355" y="485" text-anchor="middle" font-size="10" fill="#34495E">• State Transitions</text>
  <text x="355" y="500" text-anchor="middle" font-size="10" fill="#34495E">• Episode Management</text>
  
  <!-- Training Box -->
  <rect x="480" y="400" width="150" height="120" fill="#ECF0F1" stroke="#34495E" stroke-width="1.5" rx="5"/>
  <text x="555" y="420" text-anchor="middle" font-size="12" font-weight="bold" fill="#2C3E50">Training Process</text>
  <text x="555" y="440" text-anchor="middle" font-size="10" fill="#34495E">• γ = 0.95 (discount)</text>
  <text x="555" y="455" text-anchor="middle" font-size="10" fill="#34495E">• Adam Optimizer</text>
  <text x="555" y="470" text-anchor="middle" font-size="10" fill="#34495E">• MSE Loss</text>
  <text x="555" y="485" text-anchor="middle" font-size="10" fill="#34495E">• Target Update: 50 ep</text>
  <text x="555" y="500" text-anchor="middle" font-size="10" fill="#34495E">• Memory: 10k samples</text>
  
  <!-- Arrows between DRL components -->
  <g stroke="#34495E" stroke-width="2" fill="#34495E">
    <!-- Agent to Environment -->
    <line x1="230" y1="450" x2="280" y2="450" marker-end="url(#arrowhead)"/>
    <text x="255" y="445" text-anchor="middle" font-size="9" fill="#34495E">Action</text>
    
    <!-- Environment to Agent -->
    <line x1="280" y1="480" x2="230" y2="480" marker-end="url(#arrowhead)"/>
    <text x="255" y="495" text-anchor="middle" font-size="9" fill="#34495E">State, Reward</text>
    
    <!-- Agent to Training -->
    <line x1="230" y1="460" x2="480" y2="460" marker-end="url(#arrowhead)"/>
    <text x="355" y="455" text-anchor="middle" font-size="9" fill="#34495E">Experience</text>
    
    <!-- Training to Agent -->
    <line x1="480" y1="440" x2="230" y2="440" marker-end="url(#arrowhead)"/>
    <text x="355" y="435" text-anchor="middle" font-size="9" fill="#34495E">Updates</text>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495E" />
    </marker>
  </defs>
  
  <!-- Network Parameters -->
  <rect x="880" y="120" width="280" height="280" fill="#F8F9FA" stroke="#DEE2E6" stroke-width="1" rx="5"/>
  <text x="1020" y="145" text-anchor="middle" font-size="14" font-weight="bold" fill="#2C3E50">Network Parameters</text>
  
  <text x="900" y="170" font-size="11" font-weight="bold" fill="#495057">Architecture:</text>
  <text x="900" y="185" font-size="10" fill="#6C757D">• Input: state_dim features</text>
  <text x="900" y="200" font-size="10" fill="#6C757D">• Hidden 1: 256 neurons + ReLU + Dropout(0.2)</text>
  <text x="900" y="215" font-size="10" fill="#6C757D">• Hidden 2: 256 neurons + ReLU + Dropout(0.2)</text>
  <text x="900" y="230" font-size="10" fill="#6C757D">• Hidden 3: 128 neurons + ReLU</text>
  <text x="900" y="245" font-size="10" fill="#6C757D">• Output: action_dim (linear)</text>
  
  <text x="900" y="270" font-size="11" font-weight="bold" fill="#495057">Hyperparameters:</text>
  <text x="900" y="285" font-size="10" fill="#6C757D">• Learning Rate: 0.001</text>
  <text x="900" y="300" font-size="10" fill="#6C757D">• Discount Factor (γ): 0.95</text>
  <text x="900" y="315" font-size="10" fill="#6C757D">• Epsilon: 1.0 → 0.01 (decay: 0.995)</text>
  <text x="900" y="330" font-size="10" fill="#6C757D">• Batch Size: 32</text>
  <text x="900" y="345" font-size="10" fill="#6C757D">• Memory Buffer: 10,000</text>
  <text x="900" y="360" font-size="10" fill="#6C757D">• Target Network Update: Every 50 episodes</text>
  <text x="900" y="375" font-size="10" fill="#6C757D">• Optimizer: Adam</text>
  <text x="900" y="390" font-size="10" fill="#6C757D">• Loss Function: MSE</text>
  
  <!-- Footer -->
  <text x="600" y="780" text-anchor="middle" font-size="12" fill="#6C757D" font-style="italic">
    Deep Q-Network architecture for recommendation system with experience replay and target network
  </text>
  
</svg>